package com.springmvc.api;

import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.json.JSONArray;
import org.json.JSONObject;

import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.nio.charset.StandardCharsets;

public class CsvToJsonConverter {

    public static void jsonConverter() {
        // 상대 경로 사용
        String csvFilePath = "csv/stadiumInGN.csv"; // 프로젝트 루트 디렉토리에서 상대 경로

        try (InputStream inputStream = CsvToJsonConverter.class.getClassLoader().getResourceAsStream(csvFilePath);
        	 InputStreamReader reader = new InputStreamReader(inputStream, "EUC-KR");
             CSVParser csvParser = new CSVParser(reader, CSVFormat.DEFAULT.withFirstRecordAsHeader())) {

            JSONArray jsonArray = new JSONArray();
            for (CSVRecord csvRecord : csvParser) {
                JSONObject jsonObject = new JSONObject();
                csvRecord.toMap().forEach((key, value) -> jsonObject.put(key, value));
                jsonArray.put(jsonObject);
                System.out.println(jsonObject.getJSONObject("연면적"));
            }

            // JSON 출력
            //System.out.println(jsonArray.toString(2)); // 2는 JSON을 들여쓰기 하기 위한 간격

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static void main(String[] args) {
        // jsonConverter 함수 호출
        jsonConverter();
    }
}
